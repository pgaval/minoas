<?xml version="1.0" encoding="UTF-8"?>
<pageflow-definition
    xmlns="http://jboss.com/products/seam/pageflow"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://jboss.com/products/seam/pageflow http://jboss.com/products/seam/pageflow-2.0.xsd"
  name="school-record">
  
  <start-state name="start">
		<transition to="isSchoolSelected" />
	</start-state>
	
	<decision name="isSchoolSelected" expression="#{activeSchool ne null}">
		<transition to="schoolRecordPage" name="true" />
		<transition to="searchSchoolPage" name="false" />
	</decision>
	
	<page name="searchSchoolPage" view-id="/schools.xhtml">
		<description>Καρτέλας Σχολικής Μονάδας - Αναζήτηση Σχολικής Μονάδας</description>
		<redirect />
		<transition to="schoolRecordPage" name="school-selected">
			<action expression="#{schoolSearch.selectSchool}"></action>
		</transition>
	</page>
	
	<page name="schoolRecordPage" view-id="/school.xhtml" back="enabled">
		<description>Καρτέλας Σχολικής Μονάδας - #{activeSchool.title}</description>
		<redirect />
		<transition to="searchSchoolPage" name="select-other-school">
			<action expression="#{schoolRecord.reset}" />
		</transition>
		<transition to="home" name="close-school-record">
			<action expression="#{schoolRecord.end}" />
		</transition>
		<transition to="employeePage" name="regular-employment-selected">
			<action expression="#{schoolRecord.selectRegularEmployment}" />
		</transition>
		<transition to="employeePage" name="deputy-employment-selected">
			<action expression="#{schoolRecord.selectDeputyEmployment}" />
		</transition>
		<transition to="employeePage" name="secondment-selected">
			<action expression="#{schoolRecord.selectSecondment}" />
		</transition>
		
	</page>
	
	
	<page name="employeePage" view-id="/employee.xhtml" back="enabled">
		<description>Καρτέλα Εκπαιδευτικού - #{employeeUtil.prettyFormat(activeEmployee)}</description>
		<redirect />	
		<transition to="schoolRecordPage" name="back" />
	</page>
	
	<page name="home" view-id="/home.xhtml">
		<end-conversation/>
		<redirect />
	</page>
	
</pageflow-definition>