<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:rich="http://richfaces.org/rich" 
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:s="http://jboss.com/products/seam/taglib">

<ui:composition template="#{theme.template}">
	<ui:define name="body">
			<rich:panel bodyClass="post" headerClass="pagetitle">
				<f:facet name="header">
					<h:outputText value="Διαχείρηση Ομάδων Ρόλων ..." />
				</f:facet>
				<s:div>
					<h:outputText
						value="Στον παρακάτω πίνακα εμφανίζονται οι διαθέσιμες ομάδες ρόλων που έχουν οριστεί στο σύστημα." />
					<s:button action="#{roleGroupManagement.end()}" value="Τέλος Διαχείρησης" view="/home.xhtml"/>
				</s:div>

				<h:panelGrid columns="1" width="100%">
					<h:messages globalOnly="true" showDetail="true" />
					<h:panelGroup>
						<a4j:outputPanel ajaxRendered="true">
						<h:form>
							<rich:dataTable id="existingRoleGroupListing" width="100%"
								rows="10" rendered="#{roleGroups.rowCount gt 0}"
								var="a_roleGroup" value="#{roleGroups}">
								<f:facet name="header">
									<h:outputText value="Διαθέσιμες Ομάδες Ρόλων" />
								</f:facet>

								<rich:column>
									<f:facet name="header">
										<h:outputText value="Όνομα Ομάδας" />
									</f:facet>
									<h:outputText value="#{a_roleGroup.id}" />
								</rich:column>
								<rich:column>
									<f:facet name="header">
										<h:outputText value="Περιγραφή Ομάδας" />
									</f:facet>
									<a4j:commandLink id="updateRoleLink"
										value="#{a_roleGroup.title}"
										action="#{roleGroupManagement.selectRoleGroup()}"
										oncomplete="javascript:Richfaces.showModalPanel('updateRoleGroupPanel');">
									</a4j:commandLink>
								</rich:column>
								<rich:column>
									<f:facet name="header">
										<h:outputText value="Ρόλοι" />
									</f:facet>
									<a4j:commandLink id="updasteRoleLink"
										value="#{a_roleGroup.roles.size()}"
										action="#{roleGroupManagement.selectRoleGroup}"
										reRender="updateRoleGroupRolesPanel"
										oncomplete="javascript:Richfaces.showModalPanel('updateRoleGroupRolesPanel');">
									</a4j:commandLink>
								</rich:column>
								<rich:column>
									<f:facet name="header">
										<h:outputText value="Ενέργεια ..." />
									</f:facet>
									<a4j:commandLink id="removeRoleLink" value="Διαγραφή Ομάδας"
										action="#{roleGroupManagement.selectRoleGroup}"
										oncomplete="javascript:Richfaces.showModalPanel('removeRoleGroupPanel');">
									</a4j:commandLink>

								</rich:column>
								<f:facet name="footer">
									<rich:datascroller align="right" for="existingRoleGroupListing"
										maxPages="10" id="sc1" renderIfSinglePage="false" />
								</f:facet>
							</rich:dataTable>
						</h:form>
					</a4j:outputPanel>
					</h:panelGroup>
				<h:panelGroup>
					<a4j:form>
						<rich:panel  bodyClass="post">
							<f:facet name="header">Δημιουργεία Νέας Ομάδας Ρόλων</f:facet>
							<h:panelGrid columns="1">
								<h:outputText value="Στην παρακάτω φόρμα μπορείτε να δημιουργήσεται μια νέα ομάδα ρόλων." />
								<h:panelGrid columns="2">
									<s:decorate id="roleNameDecoration"
										template="/layout/edit.xhtml">
										<ui:define name="label">Όνομα Ομάδας</ui:define>
										<h:inputText value="#{newRoleGroup.id}" required="true"
											size="16" maxlength="32">
											<a4j:support event="onblur" reRender="roleNameDecoration"
												bypassUpdates="true" />
											<f:validateLength minimum="5" maximum="32" />
										</h:inputText>
									</s:decorate>
									<s:decorate id="roleTitleDecoration"
										template="/layout/edit.xhtml">
										<ui:define name="label">Περιγραφή Ομάδας</ui:define>
										<h:inputText id="roletitle" value="#{newRoleGroup.title}"
											size="30" maxlength="250">
											<a4j:support event="onblur" reRender="roleTitleDecoration"
												bypassUpdates="true" />
										</h:inputText>
									</s:decorate>
								</h:panelGrid>
								<h:outputText value="Απο την παρακάτω λίστα, επιλέξετε τους ρόλους που θα περιέχονται στην νέα ομάδα." />
								<rich:pickList value="#{newRoleGroup.roles}"
									converter="rolesConverter" showButtonsLabel="false">
									<s:selectItems var="role" value="#{coreSearching.availableRoles}"
										label="#{role.id}" />
								</rich:pickList>
								<rich:message for="availableRolesShuttleList">
									<f:facet name="errorMarker">
										<h:graphicImage value="/img/error.png" />
									</f:facet>
								</rich:message>
								<a4j:commandButton value="Καταχώρηση Νέας Ομάδας"
									action="#{roleGroupManagement.saveRoleGroup()}" />
							</h:panelGrid>
						</rich:panel>
					</a4j:form>
				</h:panelGroup>

			</h:panelGrid>
			</rich:panel>


		<!-- modal panel to display when removing a given role group -->
		<rich:modalPanel id="removeRoleGroupPanel" width="200" height="150"
			resizeable="true">

			<f:facet name="header">
				<h:outputText value="Διαγραφή Ρόλου ..." />
			</f:facet>
			<f:facet name="controls">
				<h:panelGroup>
					<!-- <h:graphicImage value="/images/modal/close.png"
						style="cursor:pointer" id="hidelink" />
					 -->
					<a4j:commandLink value="[X]"
						onclick="Richfaces.hideModalPanel('removeRoleGroupPanel')" />
				</h:panelGroup>
			</f:facet>
			<h:outputText
				value="Ο Ρόλος θα διαγραφεί απο το σύστημα και η διαδικασία δεν είναι αναστρέψιμη."></h:outputText>
			<br />
			<br />
			<h:outputText value="Να γίνει η διαγραφή ?"></h:outputText>
			<br />
			<br />
			<a4j:form>
				<a4j:commandButton value="Ναι"
					action="#{roleGroupManagement.removeRoleGroup()}"
					oncomplete="Richfaces.hideModalPanel('removeRoleGroupPanel')"
					reRender="existingRoleGroupListing"></a4j:commandButton>
				<rich:spacer width="15" />
				<a4j:commandButton value="Όχι" action="#{roleGroupManagement.end()}"
					oncomplete="Richfaces.hideModalPanel('removeRoleGroupPanel')"
					reRender="existingRoleGroupListing" />
			</a4j:form>
		</rich:modalPanel>

		<rich:modalPanel id="updateRoleGroupPanel" width="200" height="150"
			resizeable="true">
			<f:facet name="header">
				<h:outputText value="Διαγραφή Ρόλου ..." />
			</f:facet>
			<f:facet name="controls">
				<h:panelGroup>
					<!-- <h:graphicImage value="/images/modal/close.png"
						style="cursor:pointer" id="hidelink" />
					 -->
					<a4j:commandLink value="[X]"
						onclick="Richfaces.hideModalPanel('updateRoleGroupPanel')" />
				</h:panelGroup>
			</f:facet>
		</rich:modalPanel>

		<!-- modal panel to be used for modifying a group role role's -->
		<a4j:outputPanel ajaxRendered="true">
			<rich:modalPanel id="updateRoleGroupRolesPanel" resizeable="false"
				autosized="true" rendered="#{selectedRoleGroup !=null}">
				<f:facet name="header">
					<h:outputText value="Ανανέωση Ομάδας Ρόλων  '#{selectedRoleGroup.id}'..." />
				</f:facet>
				<f:facet name="controls">
					<h:panelGroup>
						<a4j:commandLink value="[X]"
							onclick="Richfaces.hideModalPanel('updateRoleGroupRolesPanel')" />
					</h:panelGroup>
				</f:facet>
				<a4j:form>
					<h:panelGrid columns="1">
						<h:outputText
							value="Μπορείται να τροποποίηστε την ομάδα ρόλων αλλάζοντας την περιγραφή ή/και τους ρόλους" />
						<rich:pickList value="#{selectedRoleGroup.roles}"
							showButtonsLabel="false" disabled="#{selectedRoleGroup == null}"
							converter="rolesConverter">
							<s:selectItems var="role" value="#{coreSearching.availableRoles}"
								label="#{role.id}">
							</s:selectItems>
						</rich:pickList>
						<h:panelGroup>
							<s:button value="Τροποποίηση" action="#{roleGroupManagement.updateRoleGroup}" />
							<a4j:commandButton value="Τροποποίηση"
								action="#{roleGroupManagement.updateRoleGroup()}"
								oncomplete="Richfaces.hideModalPanel('updateRoleGroupRolesPanel')" />
							<rich:spacer width="15" />
							<a4j:commandButton value="Άκυρο"
								action="#{roleGroupManagement.search()}"
								oncomplete="Richfaces.hideModalPanel('updateRoleGroupRolesPanel')" />
						</h:panelGroup>
					</h:panelGrid>
				</a4j:form>
			</rich:modalPanel>
		</a4j:outputPanel>
	</ui:define>
</ui:composition>
</html>